"use strict";(self.webpackChunkflight_booking_system=self.webpackChunkflight_booking_system||[]).push([[584],{5584:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var a=s(5043),r=s(105),n=s(5115),o=s(5883),l=s(3867),c=s(419),i=s(2907),d=s(4975),u=s(9557),m=s(9610),h=s(8023),p=s(579);const g=()=>{const[e,t]=(0,a.useState)(null),[s,g]=(0,a.useState)(null),[b,f]=(0,a.useState)(!1),[v,x]=(0,a.useState)(!1),[k,A]=(0,a.useState)(0),[C,S]=(0,a.useState)([]),[N,j]=(0,a.useState)([]),[y,E]=(0,a.useState)({}),B=(0,u.W6)(),{userInfoSession:w,appendToUserInfoSession:T}=(0,m.q)();(0,a.useEffect)((()=>{(async()=>{const e=await h.A.getAllSeats(w.selectedFlightNumber),t=e.filter((e=>-1===e.passengerId)),s=e.filter((e=>-1!==e.passengerId));S(t),j([...t,...s]),E(F(t))})()}),[w.selectedFlightNumber]);const F=e=>{const t={};return e.forEach((e=>{t[e.seatNumber]=e.price+Math.floor(399*Math.random())-199})),t},I=e=>{const t=e.replace(/^\D+/g,"");return parseInt(t,10)};(0,a.useEffect)((()=>{b&&B.push("/payment",{selectedSeat:e,amountToBePaid:k})}),[b,B,e,k]);const M=()=>{x(!1)},D=e=>e&&-1!==e.passengerId,W=e=>e.startsWith("F")?"First Class":e.startsWith("B")?"Business Class":e.startsWith("E")?"Economy Class":"Unknown Class";return(0,p.jsxs)("div",{className:"seat-selection-container",children:[(0,p.jsx)("h2",{style:{textAlign:"center",marginBottom:"10px"},children:"Select Your Seat"}),(0,p.jsx)("div",{className:"container",children:["First Class","Business Class","Economy Class"].map((s=>(0,p.jsxs)("div",{style:{textAlign:"center",marginBottom:"20px"},children:[(0,p.jsx)("h3",{children:s}),(0,p.jsx)("div",{className:"seat-row",children:N.filter((e=>W(e.seatNumber)===s)).sort(((e,t)=>I(e.seatNumber)-I(t.seatNumber))).reduce(((e,t,a)=>{const r=Math.floor(a/("Economy Class"===s?4:3));return e[r]||(e[r]=[]),e[r].push(t),e}),[]).map(((a,r)=>(0,p.jsx)("div",{className:`seat-${s.toLowerCase()}-row`,children:a.map((s=>(0,p.jsxs)("div",{className:`seat ${e===s.seatNumber?"selected":""} ${D(s)?"booked":""}`,onClick:()=>{return e=s.seatNumber,a=s.seatClass,t((t=>t===e?null:e)),void g(a);var e,a},children:[s.seatNumber,(0,p.jsx)("br",{})]},s.seatNumber)))},r)))})]},s)))}),(0,p.jsxs)("div",{className:"selected-seats",children:[(0,p.jsx)("p",{children:`Selected Seat: ${e||"None"}`}),e&&(0,p.jsx)("p",{children:`Cost: \u20b9${y[e]}`})]}),(0,p.jsx)("br",{}),(0,p.jsxs)("div",{style:{textAlign:"center"},children:[(0,p.jsx)(r.A,{style:{backgroundColor:"#000",color:"#fff"},onClick:()=>{if(e&&C.map((e=>e.seatNumber)).includes(e)){(async()=>{const t=await h.A.bookSeats(w.selectedFlightNumber,w.userId,e,s,y[e]);console.log("Seat booking info from Backend: ",t)})(),A(y[e]),f(!0),T({selectedSeat:e,selectedClass:s,amountToBePaid:y[e]})}else x(!0)},children:"Confirm Seat"}),(0,p.jsx)(r.A,{style:{backgroundColor:"#ccc",color:"#000",marginLeft:"10px"},onClick:()=>{t(null),g(null),A(0)},children:"Clear Selection"})]}),(0,p.jsxs)(n.A,{open:v,onClose:M,children:[(0,p.jsxs)(o.A,{children:[(0,p.jsx)(d.A,{}),"Alert"]}),(0,p.jsx)(l.A,{children:(0,p.jsx)(c.A,{children:D(e)?"This seat is already booked":"Please select a seat before confirming"})}),(0,p.jsx)(i.A,{children:(0,p.jsx)(r.A,{onClick:M,color:"primary",variant:"contained",children:"OK"})})]})]})}},8023:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(9217),r=s(6213);class n{}n.getAllSeats=e=>{const t=a.b+"booking/getAllSeats/"+e;return r.A.get(t).then((e=>e.data)).catch((e=>(console.log("Error in Backend call, sending back empty seats",e),[])))},n.bookSeats=(e,t,s,n,o)=>{const l=a.b+"booking/bookSeats/"+e+"/"+t,c={seatNumber:s,seatClass:n,price:o,booked:!1};return r.A.post(l,c).then((e=>e.data)).catch((e=>(console.log("Error in Backend call, sending back empty booking",e),null)))},n.createReservation=(e,t,s,n)=>{const o=a.b+"payment/createReservation/"+e+"/"+t+"/"+s,l={totalTravelFair:n};return r.A.post(o,l).then((e=>e.data)).catch((e=>(console.log("Error in Backend call, sending back empty reservation",e),null)))},n.selectFlight=(e,t,s,n,o,l,c,i)=>{const d=a.b+"booking/bookFlights/"+e,u={flightNumber:t,departure:s,arrival:n,departureDate:o,departureTime:l,arrivalDate:c,arrivalTime:i,seatAvailability:30};return r.A.post(d,u).then((e=>e.data)).catch((e=>(console.log("Error in Backend call, sending back empty select flight",e),null)))}},419:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(8168),r=s(5043),n=s(7573),o=s(6187),l=r.forwardRef((function(e,t){return r.createElement(o.A,(0,a.A)({component:"p",variant:"body1",color:"textSecondary",ref:t},e))}));const c=(0,n.A)({root:{marginBottom:12}},{name:"MuiDialogContentText"})(l)},3867:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(8168),r=s(45),n=s(5043),o=s(3024),l=s(7573),c=n.forwardRef((function(e,t){var s=e.classes,l=e.className,c=e.dividers,i=void 0!==c&&c,d=(0,r.A)(e,["classes","className","dividers"]);return n.createElement("div",(0,a.A)({className:(0,o.A)(s.root,l,i&&s.dividers),ref:t},d))}));const i=(0,l.A)((function(e){return{root:{flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"8px 24px","&:first-child":{paddingTop:20}},dividers:{padding:"16px 24px",borderTop:"1px solid ".concat(e.palette.divider),borderBottom:"1px solid ".concat(e.palette.divider)}}}),{name:"MuiDialogContent"})(c)},4975:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(5043);const r=(0,s(4794).A)(a.createElement("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline")}}]);
//# sourceMappingURL=584.d76265fd.chunk.js.map